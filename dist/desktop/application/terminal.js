var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var core_1 = require('angular2/core');
var common_1 = require('angular2/common');
var shortcut_1 = require('../shortcut/shortcut');
var window_1 = require('../panel/window');
var TerminalCmp = (function (_super) {
    __extends(TerminalCmp, _super);
    function TerminalCmp(elementRef) {
        var _this = this;
        _super.call(this);
        this.shortcuts = [];
        this.width = 630;
        this.height = 400;
        this.element = elementRef.nativeElement;
        this.setDialog();
        setTimeout(function () {
            _this.setTerminal();
        }, 100);
    }
    TerminalCmp.prototype.setTerminal = function () {
        var _this = this;
        var term = new Terminal();
        var socket = io.connect("http://" + window.location.host);
        var term_id = this.config.container_id + 'ยง' + this.config._id;
        socket.emit('createTerminal', term_id, function (term_id) {
            term.on('data', function (data) {
                socket.emit('data' + term_id, data);
            });
            term.open($(_this.element).find('.terminal-window')[0]);
            socket.on('data' + term_id, function (data) {
                term.write(data);
            });
            $(window).resize(function () {
                term.sizeToFit();
                socket.emit('resize' + term_id, {
                    cols: term.cols,
                    rows: term.rows
                });
            });
            $(window).trigger('resize');
        });
    };
    __decorate([
        core_1.Input(), 
        __metadata('design:type', Object)
    ], TerminalCmp.prototype, "config", void 0);
    TerminalCmp = __decorate([
        core_1.Component({
            selector: 'terminal',
            template: window_1.windowTemplate.replace('{{__body__}}', "\n        <div class=\"body\" style=\"overflow-y: auto;height:100%;width:100%;padding-top: 30px;text-align:center\">\n            <div class=\"terminal-window\" style=\"width:100%;height:100%;\"></div>\n        </div>\n    "),
            styles: ["\n\n\n\n      .panel{\n      \tposition: absolute;\n      \tleft:100px;\n      \ttop:100px;\n      \tborder:1px solid #ccc;\n      \tbackground-color:#fff;\n      \tborder-radius:1px;\n      }\n\n\n      .panel .header{\n      \twidth:100%;\n          height:30px;\n          text-align: left;\n      \tbackground-color:#eee;\n      }\n\n      .panel.focus .header  {\n      \tbackground-color:rgba(138,165,204,1);\n      }\n\n      .panel.focus  {\n      \tborder-color:rgba(138,165,204,1);\n      }\n\n      .panel .header .icon{\n          height: 20px;   \t\n          width: 20px;\n          float: left;\n          margin: 4px;\n          background-size: 20px 20px;\n      }\n\n      .panel .header .title{\n          padding-top: 5px;\n          float: left;\n      }\n\n      .panel-title-buttons {\n\n          height:40px;\n          float: right;\n      \tmargin-top: 2px;\n      \tmargin-right: 2px\n      }\n\n\n      .panel-btn {\n          float: right;\n          margin-right: 10px;\n          margin-top: 7px;\n          width:85px;\n          font-size:13px;\n\t\n      }\n\n      .icon-min{\n          background-image:url(../../resource/images/icon/min2.png);\n          width:40px;\n          height:19px;\n          float: left;\n      }\n      .icon-max{\n          background-image:url(../../resource/images/icon/max2.png);\n          width:40px;\n          height:19px;\n          float: left;\n      }\n      .icon-close{\n          background-image:url(../../resource/images/icon/close2.png);\n          width:40px;\n          height:19px;\n          float: left;\n      }\n\n      .icon-min:hover{\n      \tbackground-image:url(../../resource/images/icon/min.png);\n      }\n\n      .icon-max:hover{\n      \tbackground-image:url(../../resource/images/icon/max.png);\n      }\n\n      .icon-close:hover{\n      \tbackground-image:url(../../resource/images/icon/close.png);\n      }\n\n      /*window*/\n      .panel .design-resize-left, .design-resize-right  , .design-resize-bottom , .design-resize-left-bottom , .design-resize-right-bottom{\n      \tbackground:#b7bfca;\n      \tfloat: left;\n      \tposition: absolute;\n      \topacity: 0;                /* Firefox, Safari(WebKit), Opera,chrome/    filter: \"alpha(opacity=60)\"; /* IE 8 */\n      \tfilter: alpha(opacity=0);   /* IE 4-7 */\n      }\n      .design-resize-left{\n      \twidth:4px;\n      \theight: 100%;\n      \tcursor:e-resize; \n      \tleft:0px;\n      \ttop:0px;\n      }\n      .design-resize-right{\n      \twidth:4px;\n      \theight: 100%;\n      \tcursor:e-resize; \n      \tright:0px;\n      \ttop:0px;\n      }\n      .design-resize-bottom{\n      \theight:4px;\n      \twidth:100%;\n      \tcursor:n-resize;\n      \toverflow:hidden; \n      \tleft:0px;\n      \tbottom:0px;\n      }\n      .design-resize-left-bottom{\n      \theight:4px;\n      \twidth:4px;\n      \tcursor:sw-resize; \n      \tleft:0px;\n      \tbottom:0px;\n      }\n      .design-resize-right-bottom{\n      \theight:4px;\n      \twidth:4px;\n      \tcursor:se-resize; \n      \tright:0px;\n      \tbottom:0px;\n      }\n    "],
            directives: [common_1.NgStyle, shortcut_1.ShortcutCmp]
        }),
        __param(0, core_1.Inject(core_1.ElementRef)), 
        __metadata('design:paramtypes', [core_1.ElementRef])
    ], TerminalCmp);
    return TerminalCmp;
})(window_1.WindowCmp);
exports.TerminalCmp = TerminalCmp;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRlc2t0b3AvYXBwbGljYXRpb24vdGVybWluYWwudHMiXSwibmFtZXMiOlsiVGVybWluYWxDbXAiLCJUZXJtaW5hbENtcC5jb25zdHJ1Y3RvciIsIlRlcm1pbmFsQ21wLnNldFRlcm1pbmFsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHFCQUFtRCxlQUFlLENBQUMsQ0FBQTtBQUNuRSx1QkFBc0IsaUJBQWlCLENBQUMsQ0FBQTtBQUV4Qyx5QkFBNEIsc0JBQXNCLENBQUMsQ0FBQTtBQUNuRCx1QkFBMEMsaUJBQWlCLENBQUMsQ0FBQTtBQUk1RDtJQWtKaUNBLCtCQUFTQTtJQU16Q0EscUJBQWdDQSxVQUFzQkE7UUF4SnZEQyxpQkErTENBO1FBckNPQSxpQkFBT0EsQ0FBQUE7UUFQWEEsY0FBU0EsR0FBR0EsRUFBRUEsQ0FBQUE7UUFHZEEsVUFBS0EsR0FBR0EsR0FBR0EsQ0FBQUE7UUFDZEEsV0FBTUEsR0FBR0EsR0FBR0EsQ0FBQUE7UUFJTEEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsVUFBVUEsQ0FBQ0EsYUFBYUEsQ0FBQUE7UUFFdkNBLElBQUlBLENBQUNBLFNBQVNBLEVBQUVBLENBQUFBO1FBRXRCQSxVQUFVQSxDQUFDQTtZQUNWQSxLQUFJQSxDQUFDQSxXQUFXQSxFQUFFQSxDQUFBQTtRQUNuQkEsQ0FBQ0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7SUFDVEEsQ0FBQ0E7SUFFREQsaUNBQVdBLEdBQVhBO1FBQUFFLGlCQTBCQ0E7UUF6QkFBLElBQUlBLElBQUlBLEdBQUdBLElBQUlBLFFBQVFBLEVBQUVBLENBQUFBO1FBQ3pCQSxJQUFJQSxNQUFNQSxHQUFHQSxFQUFFQSxDQUFDQSxPQUFPQSxDQUFDQSxTQUFTQSxHQUFDQSxNQUFNQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFBQTtRQUN2REEsSUFBSUEsT0FBT0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsWUFBWUEsR0FBQ0EsR0FBR0EsR0FBRUEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQUE7UUFDM0RBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsRUFBRUEsT0FBT0EsRUFBRUEsVUFBQ0EsT0FBT0E7WUFFOUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLE1BQU1BLEVBQUVBLFVBQVNBLElBQUlBO2dCQUM1QixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUE7WUFDbEMsQ0FBQyxDQUFDQSxDQUFBQTtZQUVGQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUFBO1lBRXREQSxNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQSxNQUFNQSxHQUFDQSxPQUFPQSxFQUFFQSxVQUFTQSxJQUFJQTtnQkFDdEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtZQUNqQixDQUFDLENBQUNBLENBQUFBO1lBRUZBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLE1BQU1BLENBQUNBO2dCQUNoQixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUE7Z0JBQ2hCLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFDLE9BQU8sRUFBRTtvQkFDN0IsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO29CQUNmLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtpQkFDZixDQUFDLENBQUE7WUFDSCxDQUFDLENBQUNBLENBQUFBO1lBRUZBLENBQUNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLFFBQVFBLENBQUNBLENBQUFBO1FBQzVCQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNKQSxDQUFDQTtJQXpDRUY7UUFBQ0EsWUFBS0EsRUFBRUE7O09BQUNBLCtCQUFNQSxVQUFBQTtJQXJKbkJBO1FBQUNBLGdCQUFTQSxDQUFDQTtZQUNQQSxRQUFRQSxFQUFFQSxVQUFVQTtZQUNwQkEsUUFBUUEsRUFBRUEsdUJBQWNBLENBQUNBLE9BQU9BLENBQUNBLGNBQWNBLEVBQUNBLGlPQUkvQ0EsQ0FBQ0E7WUFDRkEsTUFBTUEsRUFBRUEsQ0FBQ0EsMGlHQXVJUkEsQ0FBQ0E7WUFDRkEsVUFBVUEsRUFBRUEsQ0FBQ0EsZ0JBQU9BLEVBQUVBLHNCQUFXQSxDQUFDQTtTQUNyQ0EsQ0FBQ0E7UUFRV0EsV0FBQ0EsYUFBTUEsQ0FBQ0EsaUJBQVVBLENBQUNBLENBQUFBOztvQkF1Qy9CQTtJQUFEQSxrQkFBQ0E7QUFBREEsQ0EvTEEsQUErTENBLEVBN0NnQyxrQkFBUyxFQTZDekM7QUE3Q1ksbUJBQVcsY0E2Q3ZCLENBQUEiLCJmaWxlIjoiZGVza3RvcC9hcHBsaWNhdGlvbi90ZXJtaW5hbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBJbmplY3QsIEVsZW1lbnRSZWYsIElucHV0fSBmcm9tICdhbmd1bGFyMi9jb3JlJztcbmltcG9ydCB7TmdTdHlsZX0gZnJvbSAnYW5ndWxhcjIvY29tbW9uJztcbmltcG9ydCB7ZGlhbG9nfSBmcm9tICcuLi90b29scy91dGlsJztcbmltcG9ydCB7IFNob3J0Y3V0Q21wIH0gZnJvbSAnLi4vc2hvcnRjdXQvc2hvcnRjdXQnO1xuaW1wb3J0IHsgV2luZG93Q21wLCB3aW5kb3dUZW1wbGF0ZSB9IGZyb20gJy4uL3BhbmVsL3dpbmRvdyc7XG5cbmRlY2xhcmUgdmFyICQsIFRlcm1pbmFsLCBpb1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ3Rlcm1pbmFsJyxcbiAgICB0ZW1wbGF0ZTogd2luZG93VGVtcGxhdGUucmVwbGFjZSgne3tfX2JvZHlfX319JyxgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJib2R5XCIgc3R5bGU9XCJvdmVyZmxvdy15OiBhdXRvO2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7cGFkZGluZy10b3A6IDMwcHg7dGV4dC1hbGlnbjpjZW50ZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXJtaW5hbC13aW5kb3dcIiBzdHlsZT1cIndpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7XCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIGApLFxuICAgIHN0eWxlczogW2BcblxuXG5cbiAgICAgIC5wYW5lbHtcbiAgICAgIFx0cG9zaXRpb246IGFic29sdXRlO1xuICAgICAgXHRsZWZ0OjEwMHB4O1xuICAgICAgXHR0b3A6MTAwcHg7XG4gICAgICBcdGJvcmRlcjoxcHggc29saWQgI2NjYztcbiAgICAgIFx0YmFja2dyb3VuZC1jb2xvcjojZmZmO1xuICAgICAgXHRib3JkZXItcmFkaXVzOjFweDtcbiAgICAgIH1cblxuXG4gICAgICAucGFuZWwgLmhlYWRlcntcbiAgICAgIFx0d2lkdGg6MTAwJTtcbiAgICAgICAgICBoZWlnaHQ6MzBweDtcbiAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgXHRiYWNrZ3JvdW5kLWNvbG9yOiNlZWU7XG4gICAgICB9XG5cbiAgICAgIC5wYW5lbC5mb2N1cyAuaGVhZGVyICB7XG4gICAgICBcdGJhY2tncm91bmQtY29sb3I6cmdiYSgxMzgsMTY1LDIwNCwxKTtcbiAgICAgIH1cblxuICAgICAgLnBhbmVsLmZvY3VzICB7XG4gICAgICBcdGJvcmRlci1jb2xvcjpyZ2JhKDEzOCwxNjUsMjA0LDEpO1xuICAgICAgfVxuXG4gICAgICAucGFuZWwgLmhlYWRlciAuaWNvbntcbiAgICAgICAgICBoZWlnaHQ6IDIwcHg7ICAgXHRcbiAgICAgICAgICB3aWR0aDogMjBweDtcbiAgICAgICAgICBmbG9hdDogbGVmdDtcbiAgICAgICAgICBtYXJnaW46IDRweDtcbiAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IDIwcHggMjBweDtcbiAgICAgIH1cblxuICAgICAgLnBhbmVsIC5oZWFkZXIgLnRpdGxle1xuICAgICAgICAgIHBhZGRpbmctdG9wOiA1cHg7XG4gICAgICAgICAgZmxvYXQ6IGxlZnQ7XG4gICAgICB9XG5cbiAgICAgIC5wYW5lbC10aXRsZS1idXR0b25zIHtcblxuICAgICAgICAgIGhlaWdodDo0MHB4O1xuICAgICAgICAgIGZsb2F0OiByaWdodDtcbiAgICAgIFx0bWFyZ2luLXRvcDogMnB4O1xuICAgICAgXHRtYXJnaW4tcmlnaHQ6IDJweFxuICAgICAgfVxuXG5cbiAgICAgIC5wYW5lbC1idG4ge1xuICAgICAgICAgIGZsb2F0OiByaWdodDtcbiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7XG4gICAgICAgICAgbWFyZ2luLXRvcDogN3B4O1xuICAgICAgICAgIHdpZHRoOjg1cHg7XG4gICAgICAgICAgZm9udC1zaXplOjEzcHg7XG5cdFxuICAgICAgfVxuXG4gICAgICAuaWNvbi1taW57XG4gICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTp1cmwoLi4vLi4vcmVzb3VyY2UvaW1hZ2VzL2ljb24vbWluMi5wbmcpO1xuICAgICAgICAgIHdpZHRoOjQwcHg7XG4gICAgICAgICAgaGVpZ2h0OjE5cHg7XG4gICAgICAgICAgZmxvYXQ6IGxlZnQ7XG4gICAgICB9XG4gICAgICAuaWNvbi1tYXh7XG4gICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTp1cmwoLi4vLi4vcmVzb3VyY2UvaW1hZ2VzL2ljb24vbWF4Mi5wbmcpO1xuICAgICAgICAgIHdpZHRoOjQwcHg7XG4gICAgICAgICAgaGVpZ2h0OjE5cHg7XG4gICAgICAgICAgZmxvYXQ6IGxlZnQ7XG4gICAgICB9XG4gICAgICAuaWNvbi1jbG9zZXtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOnVybCguLi8uLi9yZXNvdXJjZS9pbWFnZXMvaWNvbi9jbG9zZTIucG5nKTtcbiAgICAgICAgICB3aWR0aDo0MHB4O1xuICAgICAgICAgIGhlaWdodDoxOXB4O1xuICAgICAgICAgIGZsb2F0OiBsZWZ0O1xuICAgICAgfVxuXG4gICAgICAuaWNvbi1taW46aG92ZXJ7XG4gICAgICBcdGJhY2tncm91bmQtaW1hZ2U6dXJsKC4uLy4uL3Jlc291cmNlL2ltYWdlcy9pY29uL21pbi5wbmcpO1xuICAgICAgfVxuXG4gICAgICAuaWNvbi1tYXg6aG92ZXJ7XG4gICAgICBcdGJhY2tncm91bmQtaW1hZ2U6dXJsKC4uLy4uL3Jlc291cmNlL2ltYWdlcy9pY29uL21heC5wbmcpO1xuICAgICAgfVxuXG4gICAgICAuaWNvbi1jbG9zZTpob3ZlcntcbiAgICAgIFx0YmFja2dyb3VuZC1pbWFnZTp1cmwoLi4vLi4vcmVzb3VyY2UvaW1hZ2VzL2ljb24vY2xvc2UucG5nKTtcbiAgICAgIH1cblxuICAgICAgLyp3aW5kb3cqL1xuICAgICAgLnBhbmVsIC5kZXNpZ24tcmVzaXplLWxlZnQsIC5kZXNpZ24tcmVzaXplLXJpZ2h0ICAsIC5kZXNpZ24tcmVzaXplLWJvdHRvbSAsIC5kZXNpZ24tcmVzaXplLWxlZnQtYm90dG9tICwgLmRlc2lnbi1yZXNpemUtcmlnaHQtYm90dG9te1xuICAgICAgXHRiYWNrZ3JvdW5kOiNiN2JmY2E7XG4gICAgICBcdGZsb2F0OiBsZWZ0O1xuICAgICAgXHRwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBcdG9wYWNpdHk6IDA7ICAgICAgICAgICAgICAgIC8qIEZpcmVmb3gsIFNhZmFyaShXZWJLaXQpLCBPcGVyYSxjaHJvbWUvICAgIGZpbHRlcjogXCJhbHBoYShvcGFjaXR5PTYwKVwiOyAvKiBJRSA4ICovXG4gICAgICBcdGZpbHRlcjogYWxwaGEob3BhY2l0eT0wKTsgICAvKiBJRSA0LTcgKi9cbiAgICAgIH1cbiAgICAgIC5kZXNpZ24tcmVzaXplLWxlZnR7XG4gICAgICBcdHdpZHRoOjRweDtcbiAgICAgIFx0aGVpZ2h0OiAxMDAlO1xuICAgICAgXHRjdXJzb3I6ZS1yZXNpemU7IFxuICAgICAgXHRsZWZ0OjBweDtcbiAgICAgIFx0dG9wOjBweDtcbiAgICAgIH1cbiAgICAgIC5kZXNpZ24tcmVzaXplLXJpZ2h0e1xuICAgICAgXHR3aWR0aDo0cHg7XG4gICAgICBcdGhlaWdodDogMTAwJTtcbiAgICAgIFx0Y3Vyc29yOmUtcmVzaXplOyBcbiAgICAgIFx0cmlnaHQ6MHB4O1xuICAgICAgXHR0b3A6MHB4O1xuICAgICAgfVxuICAgICAgLmRlc2lnbi1yZXNpemUtYm90dG9te1xuICAgICAgXHRoZWlnaHQ6NHB4O1xuICAgICAgXHR3aWR0aDoxMDAlO1xuICAgICAgXHRjdXJzb3I6bi1yZXNpemU7XG4gICAgICBcdG92ZXJmbG93OmhpZGRlbjsgXG4gICAgICBcdGxlZnQ6MHB4O1xuICAgICAgXHRib3R0b206MHB4O1xuICAgICAgfVxuICAgICAgLmRlc2lnbi1yZXNpemUtbGVmdC1ib3R0b217XG4gICAgICBcdGhlaWdodDo0cHg7XG4gICAgICBcdHdpZHRoOjRweDtcbiAgICAgIFx0Y3Vyc29yOnN3LXJlc2l6ZTsgXG4gICAgICBcdGxlZnQ6MHB4O1xuICAgICAgXHRib3R0b206MHB4O1xuICAgICAgfVxuICAgICAgLmRlc2lnbi1yZXNpemUtcmlnaHQtYm90dG9te1xuICAgICAgXHRoZWlnaHQ6NHB4O1xuICAgICAgXHR3aWR0aDo0cHg7XG4gICAgICBcdGN1cnNvcjpzZS1yZXNpemU7IFxuICAgICAgXHRyaWdodDowcHg7XG4gICAgICBcdGJvdHRvbTowcHg7XG4gICAgICB9XG4gICAgYF0sXG4gICAgZGlyZWN0aXZlczogW05nU3R5bGUsIFNob3J0Y3V0Q21wXVxufSlcblxuZXhwb3J0IGNsYXNzIFRlcm1pbmFsQ21wIGV4dGVuZHMgV2luZG93Q21wIHtcbiAgICBzaG9ydGN1dHMgPSBbXSBcbiAgICBlbGVtZW50OiBhbnlcbiAgICBASW5wdXQoKSBjb25maWdcbiAgICB3aWR0aCA9IDYzMFxuXHRoZWlnaHQgPSA0MDBcblx0Y29uc3RydWN0b3IoQEluamVjdChFbGVtZW50UmVmKSBlbGVtZW50UmVmOiBFbGVtZW50UmVmKXtcbiAgICAgICAgXG4gICAgICAgIHN1cGVyKClcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50XG4gICAgICAgIFxuICAgICAgICB0aGlzLnNldERpYWxvZygpXG5cdFx0XG5cdFx0c2V0VGltZW91dCgoKT0+IHtcblx0XHRcdHRoaXMuc2V0VGVybWluYWwoKVxuXHRcdH0sIDEwMCk7XG5cdH1cblx0XG5cdHNldFRlcm1pbmFsKCl7XG5cdFx0dmFyIHRlcm0gPSBuZXcgVGVybWluYWwoKSBcblx0XHR2YXIgc29ja2V0ID0gaW8uY29ubmVjdChcImh0dHA6Ly9cIit3aW5kb3cubG9jYXRpb24uaG9zdClcblx0XHR2YXIgdGVybV9pZCA9IHRoaXMuY29uZmlnLmNvbnRhaW5lcl9pZCsnwqcnKyB0aGlzLmNvbmZpZy5faWRcblx0XHRzb2NrZXQuZW1pdCgnY3JlYXRlVGVybWluYWwnLCB0ZXJtX2lkLCAodGVybV9pZCk9PlxuXHRcdHtcblx0XHRcdHRlcm0ub24oJ2RhdGEnLCBmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0c29ja2V0LmVtaXQoJ2RhdGEnK3Rlcm1faWQsIGRhdGEpXG5cdFx0XHR9KVxuICAgICAgICAgICAgXG5cdFx0XHR0ZXJtLm9wZW4oJCh0aGlzLmVsZW1lbnQpLmZpbmQoJy50ZXJtaW5hbC13aW5kb3cnKVswXSlcblx0XHRcdFxuXHRcdFx0c29ja2V0Lm9uKCdkYXRhJyt0ZXJtX2lkLCBmdW5jdGlvbihkYXRhKXsgXG5cdFx0XHRcdHRlcm0ud3JpdGUoZGF0YSlcblx0XHRcdH0pXG5cdFx0XHRcblx0XHRcdCQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKXtcblx0XHRcdFx0dGVybS5zaXplVG9GaXQoKVxuXHRcdFx0XHRzb2NrZXQuZW1pdCgncmVzaXplJyt0ZXJtX2lkLCB7XG5cdFx0XHRcdFx0Y29sczogdGVybS5jb2xzLFxuXHRcdFx0XHRcdHJvd3M6IHRlcm0ucm93c1xuXHRcdFx0XHR9KVxuXHRcdFx0fSlcblx0XHRcdFxuXHRcdFx0JCh3aW5kb3cpLnRyaWdnZXIoJ3Jlc2l6ZScpXG5cdFx0fSk7XG5cdH1cbn1cblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9